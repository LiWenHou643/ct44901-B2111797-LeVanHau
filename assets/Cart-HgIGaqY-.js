import{_ as b,m as d,l as h,k as y,c as r,a as e,d as g,F as p,r as _,t as i,D as f,f as u,e as v,g as k,o,w as C,v as w,b as m}from"./index-HVgC_N1k.js";const Q={computed:{...d("cart",["cartItems","cartQuantity","cartTotal"]),...d("auth",["user","isAuthenticated"]),formatPrice(){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(this.cartTotal)}},methods:{...h("cart",["clearCart"]),async updateQuantity(t){this.$store.dispatch("cart/updateQuantity",{product:t,quantity:t.soluong})},increaseQuantity(t){t.soluong++,this.updateQuantity(t)},decreaseQuantity(t){t.soluong>1&&(t.soluong--,this.updateQuantity(t))},redirectToLogin(){this.$router.push({name:"login"})},removeFromCart(t){console.log("Removing from cart:",t),this.$store.dispatch("cart/removeFromCart",{product:t,quantity:-1})},async order(){try{await y.createOrder(this.user._id,this.cartItems)&&this.clearCart(),this.$router.push({name:"order"})}catch(t){console.error(t)}}}},x={class:"container"},V={class:"cart"},I={key:1,class:"card position-relative"},N={class:"card-body"},T={class:"list-group"},F={class:"d-flex justify-content-between align-items-center gap-5"},B={class:"quantity-controls"},$=["onClick","disabled"],q=["onUpdate:modelValue","onChange"],D=["onClick"],j=["onClick"],A={class:"card-footer"},G={class:"fw-bold mb-0"},X={class:"d-flex justify-content-between align-items-center"},L={class:"fw-bold mb-0"},P={key:2,class:"alert alert-info text-center mt-4"};function S(t,n,U,E,M,a){const l=k("router-link");return o(),r("div",x,[e("div",V,[n[5]||(n[5]=e("h1",{class:"text-center mb-4"},"Giỏ mượn",-1)),t.cartItems.length>0?(o(),r("button",{key:0,class:"btn btn-danger mb-2",onClick:n[0]||(n[0]=(...s)=>t.clearCart&&t.clearCart(...s))}," Xoá tất cả ")):g("",!0),t.cartItems.length>0?(o(),r("div",I,[e("div",N,[e("ul",T,[(o(!0),r(p,null,_(t.cartItems,s=>(o(),r("li",{key:s._id,class:"list-group-item d-flex justify-content-between align-items-center"},[e("span",null,i(s.tensach)+" - đ"+i(s.dongia)+" (x"+i(s.soluong)+") ",1),e("div",F,[e("div",B,[e("button",{class:"btn btn-sm btn-secondary",onClick:c=>a.decreaseQuantity(s),disabled:s.soluong<=1}," - ",8,$),C(e("input",{type:"number","onUpdate:modelValue":c=>s.soluong=c,min:"1",onChange:c=>a.updateQuantity(s),class:"form-control form-control-sm mx-2",style:{width:"60px"}},null,40,q),[[w,s.soluong]]),e("button",{class:"btn btn-sm btn-secondary",onClick:c=>a.increaseQuantity(s)}," + ",8,D)]),e("button",{class:"btn btn-danger btn-sm",onClick:c=>a.removeFromCart(s)}," Xoá ",8,j)])]))),128))])]),e("div",A,[e("p",G," Tổng sách: "+i(t.cartQuantity)+" quyển ",1),e("div",X,[e("p",L," Tổng phí mượn: "+i(a.formatPrice),1),e("div",null,[t.isAuthenticated?(o(),r("button",{key:0,class:"btn btn-primary",onClick:n[1]||(n[1]=(...s)=>a.order&&a.order(...s))}," Gửi yêu cầu ")):(o(),f(l,{key:1,to:"/login",class:"btn btn-warning"},{default:u(()=>n[2]||(n[2]=[m(" Đăng nhập để mượn ")])),_:1}))])])])])):(o(),r("div",P,[n[4]||(n[4]=e("span",{class:"text-muted"},"Bạn chưa thêm bất kì sách nào trong giỏ.",-1)),v(l,{to:{name:"books-public"},class:"alert-link"},{default:u(()=>n[3]||(n[3]=[m(" Xem ngay ")])),_:1})]))])])}const R=b(Q,[["render",S],["__scopeId","data-v-a13fb9f6"]]);export{R as default};
